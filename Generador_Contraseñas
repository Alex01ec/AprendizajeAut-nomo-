import random
import string
import pyperclip ## si el módulo pyperclip no funciona utilizaremos : py -m pip install pyperclip

# Función que genera la contraseña en base a los parámetros del usuario
def generar_contraseña(longitud, usar_mayus, usar_minus, usar_numeros, usar_especiales):
    caracteres = ""

    # Estructuras lógicas para añadir los tipos de caracteres seleccionados
    if usar_mayus:
        caracteres += string.ascii_uppercase
    if usar_minus:
        caracteres += string.ascii_lowercase
    if usar_numeros:
        caracteres += string.digits
    if usar_especiales:
        caracteres += string.punctuation

    # Validación: si el usuario no seleccionó ningún tipo de carácter
    if not caracteres:
        return "Error: Debes seleccionar al menos un tipo de carácter."

    # Generación aleatoria de la contraseña usando comprensión de listas
    # Esto repite 'longitud' veces el proceso de elegir un carácter al azar
    contraseña = ''.join(random.choice(caracteres) for _ in range(longitud))
    return contraseña


def menu():
    print("=== Generador Seguro de Contraseñas ===")
    
    # Bucle principal: se repite hasta que el usuario decida salir
    while True:
        try:
            longitud = int(input("Ingresa la longitud de la contraseña: "))
        except ValueError:
            print("⚠ Error: Debes ingresar un número entero.")
            continue  # Repite el bucle si el valor no es válido

        # Solicitar opciones de tipos de caracteres
        usar_mayus = input("¿Incluir mayúsculas? (s/n): ").lower() == 's'
        usar_minus = input("¿Incluir minúsculas? (s/n): ").lower() == 's'
        usar_numeros = input("¿Incluir números? (s/n): ").lower() == 's'
        usar_especiales = input("¿Incluir caracteres especiales? (s/n): ").lower() == 's'

        # Llamar a la función para generar la contraseña
        contraseña = generar_contraseña(longitud, usar_mayus, usar_minus, usar_numeros, usar_especiales)
        print("\nContraseña generada:", contraseña)

        # Opción para copiar la contraseña
        if "Error" not in contraseña:
            copiar = input("¿Deseas copiarla al portapapeles? (s/n): ").lower()
            if copiar == 's':
                pyperclip.copy(contraseña)
                print("¡Contraseña copiada al portapapeles!")

        # Preguntar si el usuario quiere generar otra contraseña
        repetir = input("\n¿Deseas generar otra contraseña? (s/n): ").lower()
        if repetir != 's':
            print(" ¡Gracias por usar el generador de contraseñas!")
            break  # Rompe el bucle y termina el programa


# Punto de entrada del programa
if __name__ == "__main__":
    menu()
